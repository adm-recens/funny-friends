# Render Deployment Checklist

## ‚úÖ COMPLETED FIXES

### 1. Database Schema
- [x] Reverted to compatible schema (schema.prisma)
- [x] Saved new plugin schema for future (schema.plugin-architecture.prisma)
- [x] Schema matches server code (uses Player, not PlayerProfile)
- [x] DATABASE_URL environment variable configured
- [x] SSL configuration for PostgreSQL in production

### 2. Build Configuration
- [x] Updated package.json with proper monorepo scripts
- [x] Added db:generate before builds
- [x] Simplified render-build command
- [x] Added postinstall hook for Prisma

### 3. Vite Configuration
- [x] Production build settings configured
- [x] Output directory set to dist/
- [x] Code splitting for vendor and socket.io
- [x] Minification enabled

### 4. Render Configuration (render.yaml)
- [x] PostgreSQL service configured
- [x] Web service configured
- [x] DATABASE_URL auto-linked
- [x] JWT_SECRET auto-generated
- [x] ADMIN_SETUP_KEY auto-generated
- [x] NODE_ENV set to production
- [x] PORT set to 10000
- [x] CLIENT_URL configured

### 5. Server Configuration
- [x] RummyGameManager import made conditional
- [x] Null check before using RummyGameManager
- [x] SSL enabled for PostgreSQL in production
- [x] Static file serving configured correctly

### 6. Git Configuration
- [x] .gitignore updated for monorepo
- [x] Turbo cache directory ignored
- [x] Build outputs ignored

### 7. Seed Data
- [x] Both Teen Patti and Rummy marked as active
- [x] Admin permissions will be set for all active games

## üìã PRE-DEPLOYMENT CHECKLIST

### Before Pushing to Render:

1. **Test Build Locally:**
   ```bash
   npm install
   npm run build:platform
   ```

2. **Test Prisma Generation:**
   ```bash
   npm run db:generate
   ```

3. **Verify All Dependencies:**
   - Check all workspace packages exist
   - Check all imports resolve correctly

4. **Environment Variables Needed:**
   - `DATABASE_URL` - Auto-configured by Render
   - `JWT_SECRET` - Auto-generated by Render
   - `ADMIN_SETUP_KEY` - Auto-generated by Render
   - `NODE_ENV=production`
   - `PORT=10000`
   - `CLIENT_URL` - Your Render URL

## üöÄ DEPLOYMENT STEPS

### 1. Push to GitHub
```bash
git push origin main
```

### 2. Create Render Blueprint
1. Go to Render Dashboard
2. Click "New" ‚Üí "Blueprint"
3. Connect your GitHub repository
4. Select this repository
5. Render will detect `render.yaml`

### 3. Wait for Deployment
- PostgreSQL will be created first
- Web service will wait for database
- Build process runs `npm run render-build`
- Start process runs `npm start`

### 4. Initial Setup
1. Visit your Render URL + `/system-setup`
2. Create admin user with the ADMIN_SETUP_KEY
3. Log in with admin credentials
4. Create operators and configure games

## ‚ö†Ô∏è KNOWN LIMITATIONS

1. **Plugin Architecture Schema** - Not yet migrated
   - New schema saved as `schema.plugin-architecture.prisma`
   - Migration guide in `MIGRATION_GUIDE.md`
   - Current schema is compatible with existing code

2. **Rummy Game** - May not work if package has issues
   - Import is conditional
   - Falls back to Teen Patti if unavailable

3. **Hot Reload** - Not available in production
   - All changes require redeployment

## üîß TROUBLESHOOTING

### Build Fails
1. Check npm install logs
2. Verify all workspace packages exist
3. Check Prisma generation logs
4. Check Vite build logs

### Database Connection Fails
1. Verify DATABASE_URL is set
2. Check PostgreSQL service is running
3. Check SSL configuration

### Application Won't Start
1. Check PORT is set to 10000
2. Check Prisma client is generated
3. Check database migrations have run

### 404 Errors
1. Check static file path in server.js
2. Check Vite build output directory
3. Check index.html exists in dist/

## üìä MONITORING

### Render Logs
- Build logs: View in Render dashboard
- Runtime logs: View in Render dashboard
- Database logs: View in PostgreSQL service

### Health Check
- Application health endpoint: `/api/health`
- Database connection: Check `/api/setup/status`

## üéØ SUCCESS CRITERIA

Deployment is successful when:
- [ ] Both services show "Live" in Render
- [ ] Homepage loads at your Render URL
- [ ] Setup page is accessible
- [ ] Admin user can be created
- [ ] Login works
- [ ] Game sessions can be created
- [ ] Real-time updates work (Socket.IO)

---

**Last Updated:** 2026-02-18
**Status:** Ready for Deployment ‚úÖ
